## 2024-05-23 - NPC Visual Spec Gap **Learning:** Found that `NPC` type lacked structured visual data (unlike `PlayerCharacter`), relying on implied visuals from text. Defined `NPCVisualSpec` to bridge this, enabling both static assets and AI generation prompts. **Action:** Always check core entity types for explicit visual contracts; if missing, define a spec that supports both manual paths and generative prompts.
## 2024-05-23 - Visual Spec Integration **Learning:** Integrated `NPCVisualSpec` directly into the `NPC` interface to allow fallback resolution in the visual pipeline. This decouples visual data from game logic and enables seamless fallbacks. **Action:** Ensure all entity types (Items, Spells, etc.) have an optional `visual` property that links to their respective spec.
## 2024-05-23 - Hardcoded Visuals Component Anti-pattern **Learning:** Identified `BattleMapTile.tsx` containing hardcoded switch statements for terrain colors and decoration emojis. This tightly couples visual definitions (which may need modding/theming) with rendering logic. **Action:** Created `src/config/battleMapVisuals.ts` and `TerrainVisualSpec` to separate the "what" (green grass) from the "how" (div rendering), enabling future features like biome themes or custom tilesets.
